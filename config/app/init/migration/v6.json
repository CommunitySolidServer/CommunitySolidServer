{
  "@context": "https://linkedsoftwaredependencies.org/bundles/npm/@solid/community-server/^6.0.0/components/context.jsonld",
  "@graph": [
    {
      "comment": "Handles migration of v6 account data.",
      "@id": "urn:solid-server:default:V6MigrationHandler",
      "@type": "ConditionalHandler",
      "storageKey": "v6-migration",
      "storageValue": true,
      "storage": { "@id": "urn:solid-server:default:SetupStorage" },
      "handleStorage": true,
      "source": {
        "@id": "urn:solid-server:default:V6MigrationInitializer",
        "@type": "V6MigrationInitializer",
        "versionKey": "current-server-version",
        "versionStorage": { "@id": "urn:solid-server:default:SetupStorage" },
        "accountStorage": { "@id": "urn:solid-server:default:V6MigrationAccountStorage" },
        "clientCredentialsStorage": { "@id": "urn:solid-server:default:V6MigrationClientCredentialsStorage" },
        "forgotPasswordStorage": { "@id": "urn:solid-server:default:V6MigrationForgotPasswordStorage" },
        "newStorage": { "@id": "urn:solid-server:default:AccountStorage" },
        "skipConfirmation": { "@id": "urn:solid-server:default:variable:confirmMigration" }
      }
    },

    {
      "@id": "urn:solid-server:default:V6MigrationAccountStorage",
      "@type": "Base64EncodingStorage",
      "source": {
        "comment": "Relative path of `/` is necessary to strip leading slash from keys.",
        "@type": "ContainerPathStorage",
        "relativePath": "/",
        "source": {
          "@type": "SingleContainerJsonStorage",
          "source": { "@id": "urn:solid-server:default:ResourceStore" },
          "baseUrl": { "@id": "urn:solid-server:default:variable:baseUrl" },
          "container": "/.internal/accounts/"
        }
      }
    },

    {
      "@id": "urn:solid-server:default:V6MigrationClientCredentialsStorage",
      "@type": "Base64EncodingStorage",
      "source": {
        "comment": "Relative path of `/` is necessary to strip leading slash from keys.",
        "@type": "ContainerPathStorage",
        "relativePath": "/",
        "source": {
          "@type": "SingleContainerJsonStorage",
          "source": { "@id": "urn:solid-server:default:ResourceStore" },
          "baseUrl": { "@id": "urn:solid-server:default:variable:baseUrl" },
          "container": "/.internal/accounts/credentials/"
        }
      }
    },

    {
      "@id": "urn:solid-server:default:V6MigrationForgotPasswordStorage",
      "@type": "Base64EncodingStorage",
      "source": {
        "comment": "Relative path of `/` is necessary to strip leading slash from keys.",
        "@type": "ContainerPathStorage",
        "relativePath": "/",
        "source": {
          "@type": "SingleContainerJsonStorage",
          "source": { "@id": "urn:solid-server:default:ResourceStore" },
          "baseUrl": { "@id": "urn:solid-server:default:variable:baseUrl" },
          "container": "/.internal/forgot-password/"
        }
      }
    }
  ]
}
